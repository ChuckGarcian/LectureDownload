(()=>{fetch("http://worldtimeapi.org/api/timezone/America/Chicago").then((function(e){return e.json()})).then((function(e){const t=e.datetime.substring(0,10);console.log(t),"2023-05-11"!==t?console.log("not equal"):"2023-05-11"===t&&console.log("equal!")}));var e=[];const t=new Set;function o(e){const t=Array.isArray(e)?[]:{};for(let n in e){const s=e[n];t[n]="object"==typeof s&&null!==s?o(s):s}return t}chrome.runtime.onMessage.addListener((function(e,t,o){if("getHTML"==e.message)return chrome.scripting.executeScript({target:{tabId:e.tabId},function:function(){alert("test1");const e=Array.from(document.querySelectorAll("a")),t=document.getElementsByTagName("span"),o=e.map((e=>e.href)).filter((e=>e.startsWith("https://lecturecapture.la.utexas.edu")));for(var n=[],s=0;s<o.length;s++)n.push({link:o[s],title:t[s].textContent,captionURL:null});alert("test1wwe"),chrome.runtime.sendMessage({message:"extractedLinks",extractedData:n})}}),!0})),chrome.runtime.onMessage.addListener((function(t,n,s){"extractedLinks"===t.message&&(console.log(e),console.log(t.extractedData),e=o(t.extractedData),console.log(t.extractedData),console.log(e),a())}));var n=0,s=[];function a(){if(0===e.length){console.log("DONE");for(var o=0;o<l.length;o++)s.push({videoURL:l[o].url,title:l[o].title,captionURL:r[o]});return chrome.runtime.sendMessage({message:"downloadData",data:s}),void console.log(s)}const n=e[0].link;chrome.tabs.create({url:n,active:!1},(function(e){t.add(e.id)}))}var r=[];chrome.webRequest.onBeforeRequest.addListener((function(o){t.has(o.tabId)&&o.url.includes("chunklist_")?(console.log("Computed Computed!"),l.push({url:o.url,title:e[0].title}),console.log(l),n+=1):o.url.includes("caption_proxy")&&(console.log("CAPTION_URL",o.url),r.push(o.url))}),{urls:["<all_urls>"]});var l=[];chrome.tabs.onUpdated.addListener((function(o,s,r){"complete"==s.status&&chrome.tabs.get(o,(function(s){setTimeout((function(){"complete"===s.status&&"loading"!=s.status&&t.has(o)&&(console.log("Tab "+o+" has finished loading"),console.log(n),chrome.tabs.remove(o),e.shift(),a(),t.delete(o))}),500)}))}))})();